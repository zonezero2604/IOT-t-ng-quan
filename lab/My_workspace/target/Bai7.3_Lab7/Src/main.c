/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2022 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>
#include "led.h"
#include "lightsensor.h"

void Led_sensor(unsigned int lux);

int main(void)
{
	unsigned int lux;
	LedControl_Init();
	LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 0);
	LightSensor_Init(ADC_READ_MODE_DMA);

    /* Loop forever */
	while(1)
		{
			lux = LightSensor_MeasureUseDMAMode();
			Led_sensor(lux);
		}
}

void Led_sensor(unsigned int lux)
{
	if(lux < 1800){
		LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 10);
	}
	else if(lux > 1800 && lux <2000){
		LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 15);
	}
	else if(lux > 2000 && lux <2200){
			LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 30);
		}
	else if(lux > 2200 && lux <2400){
			LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 50);
		}
	else if(lux > 2400 && lux <2600){
			LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 70);
		}
	else if(lux > 2600 && lux <3000){
			LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 90);
		}
	else {
			LedControl_SetColorGeneral(LED_BOARD_ID, LED_COLOR_GREEN, 0);
		}
}

